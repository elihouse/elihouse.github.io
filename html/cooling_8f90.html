<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Walicxe3D: /home/eli/Research/code/walicxe2d/walicxe3d/source/cooling.f90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Walicxe3D
   &#160;<span id="projectnumber">0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_42beb56e270fadc3b5d876726cd7c085.html">eli</a></li><li class="navelem"><a class="el" href="dir_16ef00058c62c26e511f5c3052371a8d.html">Research</a></li><li class="navelem"><a class="el" href="dir_9f23ad014508388c02bc7e80c90fd164.html">code</a></li><li class="navelem"><a class="el" href="dir_31f600e491ff886ff47997dfb32126a9.html">walicxe2d</a></li><li class="navelem"><a class="el" href="dir_113bedfbfe60769b44021c64bf1ac6a9.html">walicxe3d</a></li><li class="navelem"><a class="el" href="dir_ddba16501b8316ce7b3526ac89cc5b47.html">source</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">cooling.f90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Radiative cooling.  
<a href="#details">More...</a></p>

<p><a href="cooling_8f90_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a15086e2460b3086eb1e6677f807e13a7"><td class="memItemLeft" align="right" valign="top"><a id="a15086e2460b3086eb1e6677f807e13a7"></a>
subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cooling_8f90.html#a15086e2460b3086eb1e6677f807e13a7">cooling</a></td></tr>
<tr class="memdesc:a15086e2460b3086eb1e6677f807e13a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">High-level wrapper subroutine for radiative cooling. <br /></td></tr>
<tr class="separator:a15086e2460b3086eb1e6677f807e13a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93a9dc47f0780c3ff28fc758e00ff690"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cooling_8f90.html#a93a9dc47f0780c3ff28fc758e00ff690">loadcooldata</a> ()</td></tr>
<tr class="memdesc:a93a9dc47f0780c3ff28fc758e00ff690"><td class="mdescLeft">&#160;</td><td class="mdescRight">Loads radiative cooling coefficients from a data file.  <a href="cooling_8f90.html#a93a9dc47f0780c3ff28fc758e00ff690">More...</a><br /></td></tr>
<tr class="separator:a93a9dc47f0780c3ff28fc758e00ff690"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d2d2d427d68b2ee280b3c94ae125e6e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cooling_8f90.html#a4d2d2d427d68b2ee280b3c94ae125e6e">loadcooldata_metal</a> ()</td></tr>
<tr class="memdesc:a4d2d2d427d68b2ee280b3c94ae125e6e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Loads radiative cooling coefficients for 2D (T,Z) data.  <a href="cooling_8f90.html#a4d2d2d427d68b2ee280b3c94ae125e6e">More...</a><br /></td></tr>
<tr class="separator:a4d2d2d427d68b2ee280b3c94ae125e6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9735a8ce5e6927eadc1df56d0d7576d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cooling_8f90.html#ad9735a8ce5e6927eadc1df56d0d7576d">apply_cooling</a> (bIndx, maxloss)</td></tr>
<tr class="memdesc:ad9735a8ce5e6927eadc1df56d0d7576d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies radiative cooling to a block.  <a href="cooling_8f90.html#ad9735a8ce5e6927eadc1df56d0d7576d">More...</a><br /></td></tr>
<tr class="separator:ad9735a8ce5e6927eadc1df56d0d7576d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7c9e20783051f0ae47d6dc741642fd4"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cooling_8f90.html#ae7c9e20783051f0ae47d6dc741642fd4">find_coef</a> (logT, coef)</td></tr>
<tr class="memdesc:ae7c9e20783051f0ae47d6dc741642fd4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interpolates a cooling cofficient from 1D temperature-tabulated data.  <a href="cooling_8f90.html#ae7c9e20783051f0ae47d6dc741642fd4">More...</a><br /></td></tr>
<tr class="separator:ae7c9e20783051f0ae47d6dc741642fd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05325e56de4470a9892d652f32e007ca"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cooling_8f90.html#a05325e56de4470a9892d652f32e007ca">find_coef_metal</a> (logT, Z, coef)</td></tr>
<tr class="memdesc:a05325e56de4470a9892d652f32e007ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interpolates a cooling cofficient from 2D temperature-metallicity tabulated data.  <a href="cooling_8f90.html#a05325e56de4470a9892d652f32e007ca">More...</a><br /></td></tr>
<tr class="separator:a05325e56de4470a9892d652f32e007ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Juan C. Toledo </dd></dl>
<dl class="section date"><dt>Date</dt><dd>8/May/2012 </dd></dl>

<p class="definition">Definition in file <a class="el" href="cooling_8f90_source.html">cooling.f90</a>.</p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="ad9735a8ce5e6927eadc1df56d0d7576d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9735a8ce5e6927eadc1df56d0d7576d">&#9670;&nbsp;</a></span>apply_cooling()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine apply_cooling </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>bIndx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>maxloss</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This employs the previously loaded tabulated cooling function. Cooling is turned off below for temperatures below the minimum value of the table (global var cool_Tmin), while above the maximum value (cool_Tmax) free-free emission, propto sqrt(T), is used. Cooling is applied by decreasing the pressure of the cell by the factor exp(-n^2*Lambda(T)*dt/e0) where lambda(T) is the temperature-dependent cooling function (in units of erg cm^3 s^-1), n is the number density, dt is the timestep and e0 is the initial thermal energy density of the cell. This comes from taking the energy density loss rate, -n^2*Lambda(T), and assuming Lambda(T) is approx. linear throughout the small interval dt. The cooling factor is limited to being at least as large as the parameter cooling_limit. Also, a locally-defined temperature floor is enforced. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">bIndx</td><td>The local index of the block </td></tr>
    <tr><td class="paramname">maxloss</td><td>Maximum fractional thermal energy loss observed </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="cooling_8f90_source.html#l00236">236</a> of file <a class="el" href="cooling_8f90_source.html">cooling.f90</a>.</p>

</div>
</div>
<a id="ae7c9e20783051f0ae47d6dc741642fd4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7c9e20783051f0ae47d6dc741642fd4">&#9670;&nbsp;</a></span>find_coef()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine find_coef </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>logT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>coef</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">logT</td><td>The base-10 logarithm of the temperature (Kelvin) </td></tr>
    <tr><td class="paramname">coef</td><td>Interpolated cooling coefficient </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="cooling_8f90_source.html#l00328">328</a> of file <a class="el" href="cooling_8f90_source.html">cooling.f90</a>.</p>

</div>
</div>
<a id="a05325e56de4470a9892d652f32e007ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05325e56de4470a9892d652f32e007ca">&#9670;&nbsp;</a></span>find_coef_metal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine find_coef_metal </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>logT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>Z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>coef</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">logT</td><td>Base-10 logarithm of temperature (Kelvin) </td></tr>
    <tr><td class="paramname">Z</td><td>Metallicity (fraction of metals) </td></tr>
    <tr><td class="paramname">coef</td><td>Interpolated cooling coefficient</td></tr>
  </table>
  </dd>
</dl>
<p>The subroutines assumes cooltable holds 2D tabulated coefficients in the form cooltable(T,Z), where each dimension holds nptsT+1 and nptsZ+1 values. The first row and the first column state the temperature/metallicity values, while the inner rows and columns hold the corresponding coefficients. Below Tmin, cooling is set to zero. Above Tmax, the linear interpolation with respect to temperature is changed to an extrapolation using a ~sqrt(T) law. Extrapolation over metallicity is linear on both ends. </p>

<p class="definition">Definition at line <a class="el" href="cooling_8f90_source.html#l00385">385</a> of file <a class="el" href="cooling_8f90_source.html">cooling.f90</a>.</p>

</div>
</div>
<a id="a93a9dc47f0780c3ff28fc758e00ff690"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93a9dc47f0780c3ff28fc758e00ff690">&#9670;&nbsp;</a></span>loadcooldata()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine loadcooldata</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Loads radiative cooling coefficients from a data file into the cooldata global array. The number of data points must defined in the first line of the data file, and every subsequent line must have a pair of data values containing the logarithms of temperature and the cooling rate, with the latter multiplied by -1 so it's positive. Example table: 5 4.0 23.4 4.5 22.9 5.0 22.5 5.5 21.7 6.0 20.8 </p>

<p class="definition">Definition at line <a class="el" href="cooling_8f90_source.html#l00088">88</a> of file <a class="el" href="cooling_8f90_source.html">cooling.f90</a>.</p>

</div>
</div>
<a id="a4d2d2d427d68b2ee280b3c94ae125e6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d2d2d427d68b2ee280b3c94ae125e6e">&#9670;&nbsp;</a></span>loadcooldata_metal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine loadcooldata_metal</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Loads radiative cooling coefficients in the (T,Z) plane from a data file into the cooldata global array. The number of temperature and metallicity data points must defined in the first line of the data file, separated by blank. The second line must contain a blank-separated list of metallicity values. Then, every subsequent line must contain, first, the temperature, and then the corresponding cooling coefficients for each metallicity value. The temperatures and cooling coefficients must be given logarithmically, and are kept that way. Example table: 3 2 1.0 10.0 4.0 -23.4 -22.3 4.5 -22.7 -21.4 5.0 -22.1 -20.8 </p>

<p class="definition">Definition at line <a class="el" href="cooling_8f90_source.html#l00155">155</a> of file <a class="el" href="cooling_8f90_source.html">cooling.f90</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Sep 12 2023 11:44:14 for Walicxe3D by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
